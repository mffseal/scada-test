from scapy.all import *
from scapy.layers.l2 import Ether


job_read = b'\x00\x0f\xb5\x4d\xbe\xf3\x00\x0c\x29\xc0\x32\xf4\x08\x00\x45\x00\x00\x47\x23\xf6\x40\x00\x80\x06\x52\xab\xc0\xa8\x01\xb4\xc0\xa8\x01\x0b\x04\x5d\x00\x66\xd9\x0a\x79\x64\xd3\x37\x77\x98\x50\x18\xff\xce\xe1\xe0\x00\x00\x03\x00\x00\x1f\x02\xf0\x80\x32\x01\x00\x00\x00\x00\x00\x0e\x00\x00\x04\x01\x12\x0a\x10\x02\x00\x04\x00\x01\x84\x00\x00\x00\xda\xc9\x39\x38\x6b\xf9\xbe\x3c'

writers = PcapWriter('s7_read.pcap')

pkt_job_read = Ether(job_read)
pkt_job_read.time = 0
writers.write(pkt=pkt_job_read)

# # 设置每个数据包的间隔时间
# myreader = PcapReader('test.pcap')
# writers1 = PcapWriter('test1.pcap')
# count=0
# for p in myreader:
#     count=count+1
#     a = p
#     if(count>1):
#         a.time=a.time+0.01
#     writers1.write(pkt=a)
